trigger:
- master

pool:
  vmImage: 'Ubuntu-16.04'

steps:
- task: NodeTool@0
  inputs:
    versionSpec: '10.x'
  displayName: 'Install Node.js'

- script: |
    sudo npm install -g @microsoft/rush
  displayName: 'Install Rush'

# Install dependencies for building the midi NPM package
- script: |
    sudo apt-get -y install libasound2-dev
  displayName: 'Install Rush'

- script: |
    rush install --no-link
  displayName: 'rush install --no-link'

- script: |
    rush link
  displayName: 'rush link'
  
- script: |
    rush rebuild --verbose
  displayName: 'rush rebuild --verbose'
  
- script: |
    rush test --verbose
  displayName: 'rush test --verbose'
